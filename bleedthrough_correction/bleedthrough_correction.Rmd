---
title: "bleedthrough correction"
author: "ChacÃ³n"
date: "2022-11-02"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

## Bleedthrough correction

This document shows how to get species-specific OD values from coculture fluorescence measurements.

At minimum, in addition to the coculture measurement, one also needs growth curves with OD and fluorescence for each monoculture. Fluorescence must be measured in each channel which is used in the coculture experiment.

For example, if running a coculture with E0 and S0, that means each monoculture should be measured with CFP (E0's fluorescent protein) and YFP (S0's fluorescent protein).

As an important note, the relationship between fluorescence and OD is specific to a medium. This can create challenges during mutualistic growth when one doesnt know the actual medium. Please keep that in mind when you do your own analyses.

# Load Data

I am going to enter data from an actual TECAN run of Lisa Fazzino's. It is E, or S, or E and S, in succinate.

```{r get_data}
results = structure(list(cycle = c(1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4, 
5, 5, 5, 6, 6, 6, 7, 7, 7, 8, 8, 8, 9, 9, 9, 10, 10, 10, 11, 
11, 11, 12, 12, 12, 13, 13, 13, 14, 14, 14, 15, 15, 15, 16, 16, 
16, 17, 17, 17, 18, 18, 18, 19, 19, 19, 20, 20, 20, 21, 21, 21, 
22, 22, 22, 23, 23, 23, 24, 24, 24, 25, 25, 25, 26, 26, 26, 27, 
27, 27, 28, 28, 28, 29, 29, 29, 30, 30, 30, 31, 31, 31, 32, 32, 
32, 33, 33, 33, 34, 34, 34, 35, 35, 35, 36, 36, 36, 37, 37, 37, 
38, 38, 38, 39, 39, 39, 40, 40, 40, 41, 41, 41, 42, 42, 42, 43, 
43, 43, 44, 44, 44, 45, 45, 45, 46, 46, 46, 47, 47, 47, 48, 48, 
48, 49, 49, 49, 50, 50, 50, 51, 51, 51, 52, 52, 52, 53, 53, 53, 
54, 54, 54, 55, 55, 55, 56, 56, 56, 57, 57, 57, 58, 58, 58, 59, 
59, 59, 60, 60, 60, 61, 61, 61, 62, 62, 62, 63, 63, 63, 64, 64, 
64, 65, 65, 65, 66, 66, 66, 67, 67, 67, 68, 68, 68, 69, 69, 69, 
70, 70, 70, 71, 71, 71, 72, 72, 72, 73, 73, 73, 74, 74, 74, 75, 
75, 75, 76, 76, 76, 77, 77, 77, 78, 78, 78, 79, 79, 79, 80, 80, 
80, 81, 81, 81, 82, 82, 82, 83, 83, 83, 84, 84, 84, 85, 85, 85, 
86, 86, 86, 87, 87, 87, 88, 88, 88, 89, 89, 89, 90, 90, 90, 91, 
91, 91, 92, 92, 92, 93, 93, 93, 94, 94, 94, 95, 95, 95, 96, 96, 
96, 97, 97, 97, 98, 98, 98, 99, 99, 99, 100, 100, 100, 101, 101, 
101, 102, 102, 102, 103, 103, 103, 104, 104, 104, 105, 105, 105, 
106, 106, 106, 107, 107, 107, 108, 108, 108, 109, 109, 109, 110, 
110, 110, 111, 111, 111, 112, 112, 112, 113, 113, 113, 114, 114, 
114, 115, 115, 115, 116, 116, 116, 117, 117, 117, 118, 118, 118, 
119, 119, 119, 120, 120, 120, 121, 121, 121, 122, 122, 122, 123, 
123, 123, 124, 124, 124, 125, 125, 125, 126, 126, 126, 127, 127, 
127, 128, 128, 128, 129, 129, 129, 130, 130, 130, 131, 131, 131, 
132, 132, 132, 133, 133, 133, 134, 134, 134, 135, 135, 135, 136, 
136, 136, 137, 137, 137, 138, 138, 138, 139, 139, 139, 140, 140, 
140, 141, 141, 141, 142, 142, 142, 143, 143, 143, 144, 144, 144, 
145, 145, 145, 146, 146, 146, 147, 147, 147, 148, 148, 148, 149, 
149, 149, 150, 150, 150, 151, 151, 151, 152, 152, 152, 153, 153, 
153, 154, 154, 154, 155, 155, 155, 156, 156, 156, 157, 157, 157, 
158, 158, 158, 159, 159, 159, 160, 160, 160, 161, 161, 161, 162, 
162, 162, 163, 163, 163, 164, 164, 164, 165, 165, 165, 166, 166, 
166, 167, 167, 167, 168, 168, 168, 169, 169, 169, 170, 170, 170, 
171, 171, 171, 172, 172, 172, 173, 173, 173, 174, 174, 174, 175, 
175, 175, 176, 176, 176, 177, 177, 177, 178, 178, 178, 179, 179, 
179, 180, 180, 180, 181, 181, 181, 182, 182, 182, 183, 183, 183, 
184, 184, 184, 185, 185, 185, 186, 186, 186, 187, 187, 187, 188, 
188, 188, 189, 189, 189, 190, 190, 190, 191, 191, 191, 192, 192, 
192, 193, 193, 193, 194, 194, 194, 195, 195, 195, 196, 196, 196, 
197, 197, 197, 198, 198, 198, 199, 199, 199, 200, 200, 200, 201, 
201, 201, 202, 202, 202, 203, 203, 203, 204, 204, 204, 205, 205, 
205, 206, 206, 206, 207, 207, 207, 208, 208, 208, 209, 209, 209, 
210, 210, 210, 211, 211, 211, 212, 212, 212, 213, 213, 213, 214, 
214, 214, 215, 215, 215, 216, 216, 216, 217, 217, 217, 218, 218, 
218, 219, 219, 219, 220, 220, 220, 221, 221, 221, 222, 222, 222, 
223, 223, 223, 224, 224, 224, 225, 225, 225, 226, 226, 226, 227, 
227, 227, 228, 228, 228, 229, 229, 229, 230, 230, 230, 231, 231, 
231, 232, 232, 232, 233, 233, 233, 234, 234, 234, 235, 235, 235, 
236, 236, 236, 237, 237, 237, 238, 238, 238, 239, 239, 239, 240, 
240, 240, 241, 241, 241, 242, 242, 242, 243, 243, 243, 244, 244, 
244, 245, 245, 245, 246, 246, 246, 247, 247, 247, 248, 248, 248, 
249, 249, 249, 250, 250, 250, 251, 251, 251, 252, 252, 252, 253, 
253, 253, 254, 254, 254, 255, 255, 255, 256, 256, 256, 257, 257, 
257, 258, 258, 258, 259, 259, 259, 260, 260, 260, 261, 261, 261, 
262, 262, 262, 263, 263, 263, 264, 264, 264, 265, 265, 265, 266, 
266, 266, 267, 267, 267, 268, 268, 268, 269, 269, 269, 270, 270, 
270, 271, 271, 271, 272, 272, 272, 273, 273, 273, 274, 274, 274, 
275, 275, 275, 276, 276, 276, 277, 277, 277, 278, 278, 278, 279, 
279, 279, 280, 280, 280, 281, 281, 281, 282, 282, 282, 283, 283, 
283, 284, 284, 284, 285, 285, 285, 286, 286, 286, 287, 287, 287, 
288, 288, 288, 289, 289, 289, 290, 290, 290, 291, 291, 291, 292, 
292, 292, 293, 293, 293, 294, 294, 294, 295, 295, 295, 296, 296, 
296, 297, 297, 297, 298, 298, 298, 299, 299, 299, 300, 300, 300, 
301, 301, 301, 302, 302, 302, 303, 303, 303, 304, 304, 304, 305, 
305, 305, 306, 306, 306, 307, 307, 307, 308, 308, 308, 309, 309, 
309, 310, 310, 310, 311, 311, 311, 312, 312, 312, 313, 313, 313, 
314, 314, 314, 315, 315, 315, 316, 316, 316, 317, 317, 317, 318, 
318, 318, 319, 319, 319, 320, 320, 320, 321, 321, 321, 322, 322, 
322, 323, 323, 323, 324, 324, 324, 325, 325, 325, 326, 326, 326, 
327, 327, 327, 328, 328, 328, 329, 329, 329, 330, 330, 330, 331, 
331, 331, 332, 332, 332, 333, 333, 333, 334, 334, 334, 335, 335, 
335, 336, 336, 336, 337, 337, 337, 338, 338, 338, 339, 339, 339, 
340, 340, 340, 341, 341, 341, 342, 342, 342, 343, 343, 343, 344, 
344, 344, 345, 345, 345), well = c("A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", 
"A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", 
"H2", "H11", "A11", "H2", "H11", "A11", "H2", "H11", "A11", "H2", 
"H11"), od = c(0.103100002, 0.103299998, 0.1008, 0.104999997, 
0.101400003, 0.099600002, 0.101800002, 0.102899998, 0.098899998, 
0.1021, 0.100199997, 0.097999997, 0.0999, 0.100400001, 0.097999997, 
0.099799998, 0.0986, 0.097900003, 0.099200003, 0.0986, 0.097800002, 
0.099600002, 0.098099999, 0.097400002, 0.098999999, 0.098200001, 
0.097499996, 0.099100001, 0.097800002, 0.097199999, 0.099100001, 
0.0977, 0.097599998, 0.098999999, 0.097599998, 0.0973, 0.099100001, 
0.0977, 0.097400002, 0.099200003, 0.097499996, 0.0977, 0.099100001, 
0.101599999, 0.0977, 0.099200003, 0.100699998, 0.099200003, 0.099399999, 
0.098999999, 0.098800004, 0.099399999, 0.111100003, 0.0986, 0.099399999, 
0.097400002, 0.099600002, 0.0995, 0.098899998, 0.0999, 0.099399999, 
0.099200003, 0.105899997, 0.099299997, 0.101300001, 0.0995, 0.099200003, 
0.108199999, 0.103699997, 0.099200003, 0.097400002, 0.101199999, 
0.099699996, 0.099200003, 0.099100001, 0.099200003, 0.108800001, 
0.103699997, 0.102300003, 0.110100001, 0.1087, 0.107600003, 0.111500002, 
0.101099998, 0.103100002, 0.099699996, 0.102200001, 0.099100001, 
0.098999999, 0.107699998, 0.098999999, 0.097099997, 0.1008, 0.098899998, 
0.105999999, 0.118000001, 0.106700003, 0.109099999, 0.109700002, 
0.104000002, 0.098800004, 0.102499999, 0.112800002, 0.1087, 0.1043, 
0.099100001, 0.103100002, 0.103100002, 0.102600001, 0.104999997, 
0.101300001, 0.107500002, 0.099399999, 0.108099997, 0.105499998, 
0.103500001, 0.111299999, 0.104400001, 0.107799999, 0.115599997, 
0.100900002, 0.096699998, 0.106799997, 0.1074, 0.113399997, 0.100900002, 
0.1118, 0.107799999, 0.100100003, 0.109999999, 0.105599999, 0.099799998, 
0.105400003, 0.097599998, 0.099299997, 0.105999999, 0.104199998, 
0.099299997, 0.112499997, 0.105099998, 0.105899997, 0.113700002, 
0.098499998, 0.099399999, 0.105499998, 0.098999999, 0.099399999, 
0.105099998, 0.097800002, 0.100699998, 0.102300003, 0.098099999, 
0.099399999, 0.103200004, 0.111400001, 0.099699996, 0.104199998, 
0.100500003, 0.099299997, 0.106799997, 0.112899996, 0.099200003, 
0.113499999, 0.098399997, 0.098800004, 0.106700003, 0.097400002, 
0.100100003, 0.1065, 0.100000001, 0.101099998, 0.101000004, 0.1087, 
0.101800002, 0.115199998, 0.110100001, 0.101800002, 0.1065, 0.099299997, 
0.101199999, 0.1017, 0.097800002, 0.101000004, 0.1021, 0.111900002, 
0.100699998, 0.108099997, 0.112999998, 0.101199999, 0.1087, 0.097400002, 
0.100699998, 0.106799997, 0.1043, 0.100299999, 0.104400001, 0.115599997, 
0.100599997, 0.116700001, 0.098999999, 0.100299999, 0.1127, 0.106399998, 
0.101300001, 0.1131, 0.104699999, 0.1008, 0.1149, 0.0977, 0.101000004, 
0.103399999, 0.097599998, 0.101400003, 0.109099999, 0.118000001, 
0.101099998, 0.105400003, 0.103799999, 0.1017, 0.116499998, 0.108499996, 
0.101499997, 0.106700003, 0.105300002, 0.100699998, 0.105099998, 
0.101099998, 0.101099998, 0.105999999, 0.102899998, 0.101199999, 
0.112099998, 0.100400001, 0.101099998, 0.112899996, 0.099299997, 
0.101499997, 0.111500002, 0.112800002, 0.101599999, 0.115199998, 
0.097999997, 0.101800002, 0.118199997, 0.098399997, 0.1021, 0.108099997, 
0.100000001, 0.104400001, 0.105700001, 0.100100003, 0.105099998, 
0.109499998, 0.100500003, 0.1052, 0.112099998, 0.100900002, 0.104800001, 
0.108199999, 0.100100003, 0.105099998, 0.117799997, 0.099799998, 
0.105400003, 0.110799998, 0.100500003, 0.105999999, 0.109399997, 
0.100500003, 0.105999999, 0.110299997, 0.100299999, 0.1065, 0.111199997, 
0.100199997, 0.106700003, 0.112300001, 0.101300001, 0.107199997, 
0.113399997, 0.100000001, 0.107500002, 0.114699997, 0.100000001, 
0.108499996, 0.115999997, 0.100299999, 0.109200001, 0.1175, 0.100199997, 
0.109700002, 0.119099997, 0.100400001, 0.110699996, 0.120899998, 
0.100699998, 0.111599997, 0.124300003, 0.102300003, 0.112499997, 
0.125400007, 0.101400003, 0.113200001, 0.127599999, 0.101800002, 
0.114399999, 0.129500002, 0.101999998, 0.115699999, 0.131200001, 
0.101300001, 0.1171, 0.132499993, 0.101300001, 0.118100002, 0.134100005, 
0.101000004, 0.1197, 0.135199994, 0.1008, 0.121399999, 0.136600003, 
0.101000004, 0.122400001, 0.137600005, 0.100699998, 0.124600001, 
0.138799995, 0.100699998, 0.126699999, 0.139699996, 0.100500003, 
0.128900006, 0.140699998, 0.100400001, 0.131300002, 0.1417, 0.1008, 
0.134200007, 0.142100006, 0.100900002, 0.136600003, 0.143099993, 
0.100599997, 0.140300006, 0.143600002, 0.100400001, 0.143299997, 
0.144500002, 0.100500003, 0.147300005, 0.144999996, 0.1008, 0.152199998, 
0.145600006, 0.101000004, 0.155000001, 0.1461, 0.100699998, 0.157000005, 
0.146799996, 0.100699998, 0.159500003, 0.147, 0.100000001, 0.162, 
0.147699997, 0.100100003, 0.164100006, 0.148100004, 0.099699996, 
0.166099995, 0.148599997, 0.100000001, 0.168200001, 0.149200007, 
0.100000001, 0.169300005, 0.149499997, 0.0999, 0.170900002, 0.150000006, 
0.100599997, 0.172700003, 0.150399998, 0.100000001, 0.173999995, 
0.151099995, 0.0995, 0.174899995, 0.151500002, 0.1021, 0.176100001, 
0.152199998, 0.100400001, 0.177200004, 0.152500004, 0.100299999, 
0.178800002, 0.152999997, 0.101199999, 0.180099994, 0.153500006, 
0.100500003, 0.180800006, 0.153999999, 0.100699998, 0.181600004, 
0.154400006, 0.1008, 0.182099998, 0.154799998, 0.100100003, 0.183300003, 
0.155399993, 0.101400003, 0.184100002, 0.155900002, 0.100599997, 
0.184900001, 0.156299993, 0.100500003, 0.185800001, 0.156900004, 
0.101599999, 0.186100006, 0.157499999, 0.100599997, 0.186900005, 
0.157900006, 0.101199999, 0.188099995, 0.158199996, 0.100400001, 
0.188600004, 0.158600003, 0.100500003, 0.189500004, 0.159299999, 
0.1008, 0.190400004, 0.159700006, 0.100000001, 0.191200003, 0.1602, 
0.0999, 0.1919, 0.160699993, 0.101899996, 0.192699999, 0.1611, 
0.100199997, 0.194199994, 0.161300004, 0.100500003, 0.194299996, 
0.162100002, 0.100900002, 0.194499999, 0.162499994, 0.1008, 0.194000006, 
0.163100004, 0.101599999, 0.194199994, 0.163299993, 0.100400001, 
0.194199994, 0.164000005, 0.1021, 0.193800002, 0.164299995, 0.102399997, 
0.193800002, 0.164800003, 0.101800002, 0.194100007, 0.164800003, 
0.1039, 0.193599999, 0.165800005, 0.102300003, 0.193599999, 0.166199997, 
0.102799997, 0.193800002, 0.166700006, 0.101199999, 0.193599999, 
0.166800007, 0.101800002, 0.193700001, 0.167400002, 0.102300003, 
0.193599999, 0.167799994, 0.101599999, 0.193599999, 0.167999998, 
0.103200004, 0.193700001, 0.168099999, 0.103299998, 0.193700001, 
0.168799996, 0.101999998, 0.193900004, 0.168899998, 0.103399999, 
0.193499997, 0.169499993, 0.102899998, 0.193100005, 0.170100003, 
0.102700002, 0.192399994, 0.170300007, 0.103200004, 0.192100003, 
0.170900002, 0.103399999, 0.191100001, 0.170599997, 0.103699997, 
0.190899998, 0.171200007, 0.104199998, 0.189899996, 0.171499997, 
0.103399999, 0.189799994, 0.171900004, 0.106299996, 0.189400002, 
0.172299996, 0.105400003, 0.189300001, 0.172600001, 0.1052, 0.189300001, 
0.172999993, 0.1052, 0.189099997, 0.173199996, 0.104500003, 0.189600006, 
0.173500001, 0.104000002, 0.189199999, 0.1734, 0.104999997, 0.188600004, 
0.174099997, 0.107600003, 0.189799994, 0.173899993, 0.107500002, 
0.188700005, 0.174199998, 0.109099999, 0.188800007, 0.174700007, 
0.106600001, 0.188999996, 0.174899995, 0.108199999, 0.188700005, 
0.1752, 0.107199997, 0.190400004, 0.175099999, 0.108099997, 0.188600004, 
0.175500005, 0.107900001, 0.188700005, 0.175699994, 0.110799998, 
0.188999996, 0.175999999, 0.1087, 0.188899994, 0.176300004, 0.109200001, 
0.188899994, 0.176300004, 0.1118, 0.188700005, 0.176499993, 0.1105, 
0.188500002, 0.176799998, 0.110299997, 0.188700005, 0.176799998, 
0.110799998, 0.192499995, 0.176899999, 0.112999998, 0.1884, 0.177000001, 
0.115199998, 0.190899998, 0.177300006, 0.113799997, 0.188700005, 
0.177399993, 0.114799999, 0.188299999, 0.177599996, 0.116099998, 
0.188500002, 0.1778, 0.116800003, 0.1884, 0.177399993, 0.115400001, 
0.189400002, 0.177900001, 0.1184, 0.188199997, 0.178000003, 0.118100002, 
0.188700005, 0.178000003, 0.117899999, 0.197400004, 0.178100005, 
0.120099999, 0.1884, 0.178200006, 0.120800003, 0.1884, 0.178299993, 
0.122400001, 0.187999994, 0.178100005, 0.126300007, 0.189700007, 
0.178299993, 0.126100004, 0.188299999, 0.178299993, 0.126399994, 
0.1884, 0.178299993, 0.127100006, 0.189600006, 0.178200006, 0.126599997, 
0.188199997, 0.177900001, 0.1329, 0.189300001, 0.178000003, 0.132699996, 
0.189400002, 0.177699998, 0.129199997, 0.188199997, 0.1778, 0.131600007, 
0.188299999, 0.177699998, 0.135000005, 0.1884, 0.177900001, 0.137099996, 
0.194399998, 0.177699998, 0.140900001, 0.196700007, 0.177499995, 
0.141599998, 0.190899998, 0.177200004, 0.143800005, 0.195299998, 
0.177100003, 0.146400005, 0.193200007, 0.177399993, 0.150900006, 
0.193000004, 0.177100003, 0.157600001, 0.188199997, 0.177300006, 
0.155599996, 0.187600002, 0.176799998, 0.155900002, 0.188099995, 
0.176599994, 0.162200004, 0.198200002, 0.176499993, 0.165299997, 
0.200900003, 0.176499993, 0.169200003, 0.1875, 0.176300004, 0.172700003, 
0.187299997, 0.176499993, 0.173299998, 0.187299997, 0.175999999, 
0.183300003, 0.188500002, 0.175600007, 0.182799995, 0.187600002, 
0.175799996, 0.182300001, 0.187700003, 0.175300002, 0.1884, 0.191400006, 
0.175400004, 0.194000006, 0.1875, 0.175300002, 0.187800005, 0.187299997, 
0.1752, 0.186700001, 0.187399998, 0.175099999, 0.188099995, 0.187600002, 
0.190300003, 0.186199993, 0.187900007, 0.174600005, 0.1866, 0.187700003, 
0.174199998, 0.185499996, 0.187399998, 0.173999995, 0.190500006, 
0.197999999, 0.174099997, 0.186700001, 0.191799998, 0.174400002, 
0.189400002, 0.202399999, 0.173999995, 0.186900005, 0.187800005, 
0.173899993, 0.193399996, 0.196099997, 0.173899993, 0.187299997, 
0.197400004, 0.173999995, 0.188899994, 0.187199995, 0.173600003, 
0.191300005, 0.187600002, 0.173999995, 0.193900004, 0.187099993, 
0.173800007, 0.1919, 0.187000006, 0.173500001, 0.191499993, 0.187800005, 
0.173600003, 0.199599996, 0.202500001, 0.174099997, 0.199599996, 
0.202099994, 0.173500001, 0.197099999, 0.1884, 0.173800007, 0.195500001, 
0.187399998, 0.173700005, 0.186100006, 0.208100006, 0.173600003, 
0.189400002, 0.187299997, 0.173800007, 0.187999994, 0.203999996, 
0.173600003, 0.186199993, 0.187199995, 0.173700005, 0.182099998, 
0.186900005, 0.173199996, 0.194100007, 0.187900007, 0.173299998, 
0.185399994, 0.188299999, 0.1734, 0.183400005, 0.187099993, 0.173600003, 
0.1796, 0.187700003, 0.173299998, 0.189700007, 0.187999994, 0.1734, 
0.178900003, 0.198699996, 0.173500001, 0.179199994, 0.198200002, 
0.173700005, 0.181400001, 0.187800005, 0.173800007, 0.1866, 0.187199995, 
0.173700005, 0.191599995, 0.206, 0.173700005, 0.185000002, 0.188199997, 
0.173600003, 0.180500001, 0.188800007, 0.173600003, 0.188600004, 
0.203700006, 0.173500001, 0.181600004, 0.197799996, 0.173600003, 
0.179299995, 0.2051, 0.173500001, 0.182099998, 0.202900007, 0.173600003, 
0.183899999, 0.197099999, 0.177399993, 0.187999994, 0.204799995, 
0.1734, 0.176899999, 0.200399995, 0.173500001, 0.175799996, 0.212300003, 
0.173199996, 0.180500001, 0.196899995, 0.173099995, 0.178399995, 
0.2007, 0.172900006, 0.1778, 0.200299993, 0.172999993, 0.176799998, 
0.192000002, 0.172900006, 0.187000006, 0.186499998, 0.173099995, 
0.177900001, 0.186399996, 0.172999993, 0.174500003, 0.193299994, 
0.173099995, 0.178000003, 0.200800002, 0.180099994, 0.177000001, 
0.208000004, 0.172800004, 0.178499997, 0.185800001, 0.172499999, 
0.173700005, 0.200100005, 0.172800004, 0.176200002, 0.203999996, 
0.172900006, 0.177599996, 0.186000004, 0.172700003, 0.174999997, 
0.186000004, 0.172700003, 0.188500002, 0.201700002, 0.172499999, 
0.183899999, 0.191200003, 0.172499999, 0.178800002, 0.200200006, 
0.172800004, 0.178800002, 0.202199996, 0.172900006, 0.176799998, 
0.199900001, 0.173099995, 0.174400002, 0.202800006, 0.172900006, 
0.184900001, 0.196899995, 0.172800004, 0.180800006, 0.203099996, 
0.172299996, 0.181099996, 0.203299999, 0.177300006, 0.172800004, 
0.201800004, 0.172600001, 0.186900005, 0.199900001, 0.172199994, 
0.176499993, 0.190599993, 0.172000006, 0.1787, 0.202199996, 0.171700001, 
0.174199998, 0.1998, 0.171200007, 0.179299995, 0.193200007, 0.171200007, 
0.173999995, 0.214499995, 0.1708, 0.172299996, 0.192499995, 0.1708, 
0.184900001, 0.199000001, 0.170399994, 0.181099996, 0.197999999, 
0.1708, 0.184200004, 0.201199993, 0.173600003, 0.173899993, 0.199900001, 
0.173299998, 0.1831, 0.194499999, 0.171200007, 0.174999997, 0.198599994, 
0.170300007, 0.172099993, 0.1954, 0.171900004, 0.180500001, 0.193000004, 
0.173099995, 0.1752, 0.194399998, 0.175799996, 0.1708, 0.193000004, 
0.172700003, 0.171900004, 0.199200004, 0.175300002, 0.177900001, 
0.190599993, 0.175799996, 0.178800002, 0.191699997, 0.170399994, 
0.178800002, 0.192599997, 0.173899993, 0.172700003, 0.194100007, 
0.170599997, 0.177200004, 0.196500003, 0.178200006, 0.172700003, 
0.197600007, 0.175799996, 0.173199996, 0.1963, 0.169100001, 0.176799998, 
0.1963, 0.168099999, 0.170300007, 0.199300006, 0.171599999, 0.169400007, 
0.202000007, 0.174500003, 0.169, 0.199900001, 0.170000002, 0.170100003, 
0.202700004, 0.167199999, 0.171299994, 0.199399993, 0.167899996, 
0.179100007, 0.1954, 0.167400002, 0.173600003, 0.193900004, 0.166899994, 
0.169, 0.194499999), cfp = c(508, 493, 499, 495, 490, 491, 493, 
478, 485, 493, 475, 490, 498, 476, 492, 490, 473, 485, 493, 483, 
488, 492, 486, 489, 487, 480, 475, 497, 484, 486, 497, 481, 488, 
493, 479, 482, 495, 487, 489, 495, 476, 487, 499, 471, 497, 492, 
477, 479, 503, 474, 483, 481, 469, 481, 480, 465, 476, 486, 466, 
477, 486, 475, 480, 488, 473, 469, 488, 473, 468, 486, 475, 469, 
485, 474, 472, 489, 465, 472, 494, 465, 477, 486, 464, 481, 482, 
466, 472, 489, 471, 468, 487, 476, 486, 483, 464, 479, 489, 471, 
478, 474, 473, 469, 489, 458, 462, 488, 471, 478, 482, 465, 471, 
483, 466, 475, 479, 467, 471, 484, 466, 467, 483, 471, 468, 490, 
469, 471, 476, 469, 481, 482, 464, 482, 487, 466, 477, 484, 471, 
479, 480, 464, 476, 479, 468, 477, 480, 463, 474, 484, 467, 479, 
489, 461, 473, 483, 469, 473, 491, 457, 472, 475, 469, 475, 482, 
472, 478, 491, 467, 477, 487, 469, 478, 487, 477, 474, 496, 473, 
474, 490, 469, 479, 492, 473, 477, 492, 462, 474, 494, 468, 486, 
501, 460, 483, 498, 474, 480, 497, 481, 495, 499, 468, 482, 492, 
468, 481, 498, 467, 488, 492, 471, 488, 492, 480, 483, 500, 467, 
490, 489, 474, 476, 493, 469, 487, 497, 467, 480, 504, 480, 488, 
506, 475, 490, 504, 461, 481, 499, 469, 489, 499, 477, 494, 505, 
466, 495, 511, 464, 490, 530, 481, 514, 525, 481, 508, 533, 477, 
504, 521, 476, 508, 518, 484, 515, 533, 481, 513, 538, 485, 523, 
537, 473, 514, 534, 480, 519, 541, 489, 519, 545, 479, 528, 539, 
479, 529, 551, 482, 538, 543, 482, 524, 552, 470, 521, 545, 470, 
530, 555, 469, 538, 568, 463, 529, 569, 469, 546, 569, 461, 534, 
590, 473, 549, 583, 468, 547, 587, 467, 549, 598, 479, 561, 617, 
472, 573, 612, 463, 570, 620, 460, 583, 630, 462, 583, 630, 461, 
597, 644, 471, 580, 654, 475, 604, 662, 485, 632, 678, 482, 647, 
683, 482, 657, 688, 479, 670, 680, 484, 678, 702, 485, 697, 704, 
488, 704, 711, 496, 718, 711, 486, 729, 720, 481, 742, 714, 471, 
740, 718, 481, 738, 715, 477, 753, 710, 467, 741, 706, 470, 767, 
711, 470, 769, 723, 473, 776, 724, 462, 779, 722, 467, 786, 747, 
483, 796, 754, 492, 812, 752, 481, 836, 757, 474, 831, 772, 479, 
843, 775, 482, 845, 783, 472, 863, 766, 482, 869, 770, 484, 858, 
773, 484, 870, 784, 483, 882, 780, 487, 883, 788, 482, 895, 801, 
488, 898, 790, 483, 899, 796, 484, 895, 796, 475, 894, 795, 484, 
894, 798, 485, 909, 791, 474, 906, 797, 472, 902, 795, 475, 909, 
793, 473, 900, 805, 468, 908, 817, 475, 924, 823, 479, 919, 829, 
485, 927, 841, 477, 934, 837, 483, 934, 857, 484, 929, 844, 489, 
938, 847, 491, 937, 845, 484, 951, 841, 484, 949, 843, 472, 944, 
835, 467, 939, 842, 472, 931, 839, 475, 941, 855, 476, 946, 877, 
488, 966, 871, 492, 955, 872, 480, 965, 882, 491, 976, 894, 491, 
970, 886, 480, 980, 871, 482, 970, 862, 474, 972, 874, 478, 976, 
873, 474, 969, 877, 479, 971, 894, 484, 986, 903, 490, 987, 906, 
500, 999, 907, 489, 998, 915, 496, 1011, 907, 489, 997, 892, 
484, 995, 893, 494, 979, 904, 475, 989, 895, 480, 993, 913, 486, 
1007, 933, 492, 1029, 936, 504, 1020, 951, 501, 1034, 934, 515, 
1034, 935, 496, 1030, 930, 489, 1003, 919, 493, 1010, 928, 488, 
1008, 929, 493, 1020, 957, 505, 1033, 945, 504, 1029, 959, 514, 
1050, 968, 515, 1039, 974, 521, 1053, 973, 518, 1058, 943, 500, 
1036, 942, 498, 1028, 950, 506, 1020, 960, 503, 1038, 981, 521, 
1060, 971, 526, 1058, 972, 521, 1050, 993, 530, 1071, 982, 534, 
1073, 978, 532, 1053, 956, 519, 1023, 974, 513, 1058, 982, 543, 
1048, 1003, 536, 1070, 1006, 546, 1081, 1004, 549, 1072, 1006, 
560, 1078, 1012, 553, 1075, 994, 543, 1062, 990, 546, 1072, 998, 
551, 1064, 999, 564, 1063, 1018, 571, 1077, 1022, 576, 1094, 
1023, 582, 1094, 1035, 585, 1086, 1041, 604, 1094, 1038, 602, 
1096, 1027, 597, 1079, 1004, 606, 1074, 1006, 603, 1073, 1002, 
621, 1071, 1022, 624, 1084, 1017, 655, 1088, 1037, 649, 1101, 
1044, 651, 1102, 1028, 656, 1095, 1035, 663, 1099, 1016, 655, 
1085, 1021, 661, 1087, 1010, 663, 1075, 1011, 662, 1089, 1032, 
682, 1109, 1034, 691, 1111, 1032, 695, 1102, 1034, 711, 1117, 
1046, 706, 1121, 1018, 689, 1107, 1018, 688, 1084, 1011, 684, 
1081, 1045, 718, 1138, 1066, 739, 1136, 1062, 732, 1128, 1067, 
741, 1146, 1080, 743, 1156, 1050, 742, 1110, 1045, 720, 1115, 
1036, 725, 1101, 1075, 759, 1148, 1074, 742, 1139, 1068, 736, 
1141, 1082, 750, 1152, 1061, 737, 1138, 1043, 731, 1120, 1043, 
732, 1121, 1058, 733, 1117, 1076, 745, 1141, 1072, 749, 1138, 
1067, 756, 1139, 1074, 747, 1141, 1066, 739, 1119, 1054, 739, 
1133, 1044, 722, 1108, 1077, 749, 1140, 1070, 758, 1140, 1077, 
752, 1129, 1085, 775, 1152, 1085, 771, 1156, 1064, 764, 1136, 
1064, 747, 1111, 1053, 739, 1123, 1045, 741, 1103, 1058, 763, 
1138, 1068, 770, 1144, 1057, 764, 1108, 1065, 765, 1120, 1039, 
765, 1098, 1035, 751, 1093, 1033, 748, 1088, 1019, 742, 1090, 
1048, 750, 1092, 1058, 766, 1109, 1052, 772, 1107, 1081, 769, 
1116, 1060, 772, 1109, 1043, 760, 1095, 1028, 738, 1090, 1036, 
753, 1076, 1054, 758, 1081, 1056, 758, 1094, 1050, 776, 1100, 
1060, 757, 1108, 1050, 766, 1100, 1045, 778, 1074, 1023, 740, 
1067, 1031, 756, 1071, 1026, 738, 1061, 1035, 757, 1085, 1060, 
768, 1080, 1048, 765, 1087, 1062, 775, 1106, 1070, 782, 1081, 
1037, 768, 1072, 1031, 750, 1061, 1035, 763, 1073, 1022, 737, 
1053, 1029, 759, 1056, 1047, 774, 1078, 1045, 763, 1059, 1048, 
762, 1073, 1060, 784, 1084, 1061, 764, 1069, 1028, 749, 1069, 
1039, 759, 1053, 1028, 753, 1058, 1011, 736, 1033, 1031, 752, 
1037, 1033, 773, 1079, 1037, 770, 1068, 1047, 753, 1073, 1039, 
782, 1060, 1033, 745, 1033, 1029, 751, 1036, 1013, 742, 1039, 
1025, 751, 1030, 1047, 766, 1048, 1034, 771, 1048), yfp = c(188, 
167, 159, 175, 163, 153, 184, 164, 153, 180, 167, 162, 185, 166, 
159, 181, 164, 157, 181, 160, 156, 184, 163, 163, 165, 159, 148, 
180, 165, 153, 187, 159, 155, 184, 161, 154, 183, 165, 155, 184, 
161, 152, 180, 160, 158, 187, 166, 154, 191, 168, 154, 161, 158, 
149, 169, 155, 151, 165, 157, 145, 168, 159, 149, 165, 161, 147, 
169, 154, 149, 157, 163, 152, 165, 161, 149, 166, 167, 143, 161, 
157, 148, 167, 159, 143, 172, 160, 148, 164, 162, 141, 162, 162, 
141, 163, 160, 146, 170, 167, 142, 167, 159, 143, 162, 157, 152, 
162, 160, 148, 165, 164, 147, 166, 161, 147, 167, 158, 153, 167, 
158, 147, 167, 154, 149, 168, 164, 141, 168, 156, 146, 165, 159, 
145, 167, 156, 145, 164, 159, 147, 167, 163, 143, 171, 157, 144, 
168, 156, 144, 168, 158, 143, 169, 152, 140, 170, 157, 143, 172, 
156, 142, 172, 168, 148, 169, 156, 146, 174, 162, 141, 165, 161, 
147, 175, 152, 147, 176, 160, 141, 182, 156, 143, 177, 161, 142, 
183, 165, 148, 186, 172, 145, 185, 153, 150, 185, 170, 158, 184, 
165, 153, 195, 160, 154, 197, 172, 152, 202, 168, 149, 197, 165, 
146, 198, 160, 150, 203, 170, 153, 212, 169, 152, 205, 177, 150, 
211, 167, 151, 236, 169, 157, 221, 165, 152, 221, 161, 149, 228, 
158, 145, 230, 158, 147, 231, 159, 149, 238, 163, 148, 255, 169, 
150, 262, 167, 151, 260, 171, 153, 271, 174, 155, 279, 164, 156, 
283, 161, 153, 296, 165, 153, 308, 163, 153, 302, 164, 154, 317, 
168, 157, 332, 173, 150, 364, 168, 159, 355, 171, 159, 362, 168, 
151, 379, 172, 154, 388, 168, 150, 413, 166, 154, 418, 162, 148, 
435, 167, 154, 445, 165, 154, 451, 169, 158, 454, 164, 157, 461, 
163, 158, 462, 171, 156, 473, 169, 151, 481, 165, 154, 481, 165, 
155, 478, 161, 159, 478, 161, 161, 479, 162, 157, 486, 162, 158, 
504, 170, 163, 503, 166, 168, 509, 167, 163, 500, 163, 160, 502, 
170, 163, 509, 164, 170, 509, 171, 174, 515, 169, 174, 513, 174, 
173, 525, 175, 173, 511, 176, 177, 518, 173, 179, 517, 171, 172, 
518, 173, 176, 511, 173, 186, 517, 173, 182, 522, 177, 184, 519, 
172, 179, 522, 181, 181, 521, 183, 180, 529, 179, 186, 529, 183, 
184, 527, 178, 190, 527, 182, 187, 536, 181, 194, 533, 190, 196, 
534, 192, 191, 532, 194, 190, 539, 189, 194, 533, 193, 193, 542, 
193, 190, 532, 195, 197, 543, 193, 197, 547, 191, 198, 547, 193, 
203, 535, 199, 196, 542, 199, 197, 540, 192, 202, 544, 200, 200, 
540, 204, 198, 551, 199, 204, 553, 208, 202, 551, 206, 200, 540, 
217, 196, 553, 210, 211, 554, 222, 200, 569, 221, 206, 559, 227, 
207, 553, 225, 202, 552, 232, 211, 561, 237, 208, 569, 242, 210, 
568, 236, 203, 559, 241, 203, 551, 243, 209, 558, 246, 206, 561, 
248, 200, 554, 261, 208, 575, 266, 206, 568, 266, 206, 562, 273, 
200, 570, 276, 208, 564, 296, 212, 587, 288, 211, 579, 292, 214, 
564, 300, 213, 568, 304, 203, 574, 309, 208, 578, 324, 211, 570, 
338, 219, 583, 339, 215, 586, 352, 216, 572, 372, 218, 586, 373, 
216, 579, 382, 213, 592, 394, 213, 588, 408, 215, 584, 409, 214, 
582, 420, 211, 592, 446, 220, 591, 466, 224, 583, 470, 221, 600, 
485, 220, 607, 522, 226, 600, 520, 224, 597, 544, 217, 588, 549, 
217, 587, 566, 218, 601, 598, 223, 601, 618, 221, 602, 659, 222, 
601, 663, 219, 601, 700, 226, 603, 729, 227, 607, 758, 231, 606, 
771, 225, 604, 803, 222, 597, 833, 221, 604, 886, 227, 620, 919, 
231, 614, 960, 227, 614, 1007, 224, 625, 1036, 227, 622, 1086, 
233, 613, 1119, 231, 614, 1176, 229, 606, 1222, 224, 617, 1291, 
227, 627, 1370, 228, 624, 1448, 226, 626, 1528, 227, 641, 1594, 
233, 621, 1667, 236, 632, 1729, 233, 620, 1799, 230, 628, 1882, 
230, 625, 1992, 233, 627, 2077, 237, 638, 2205, 230, 644, 2324, 
240, 648, 2427, 238, 647, 2537, 236, 639, 2659, 239, 638, 2722, 
235, 631, 2764, 236, 625, 2771, 232, 623, 2797, 232, 625, 2857, 
239, 635, 2881, 239, 630, 2887, 235, 628, 2951, 238, 635, 2958, 
236, 633, 2974, 240, 627, 2946, 233, 628, 2977, 230, 636, 2939, 
237, 625, 3005, 235, 630, 3057, 237, 631, 3079, 248, 636, 3086, 
236, 635, 3097, 243, 631, 3105, 241, 621, 3112, 243, 628, 3100, 
240, 629, 3111, 235, 637, 3217, 250, 648, 3231, 247, 637, 3198, 
252, 648, 3226, 244, 643, 3178, 248, 631, 3152, 243, 647, 3126, 
246, 633, 3133, 245, 648, 3159, 251, 629, 3169, 247, 637, 3170, 
246, 639, 3173, 249, 641, 3152, 246, 628, 3097, 252, 617, 3084, 
238, 629, 3114, 251, 639, 3136, 253, 631, 3129, 247, 630, 3153, 
250, 648, 3108, 250, 621, 3044, 251, 624, 3066, 249, 629, 3068, 
245, 639, 3119, 248, 637, 3102, 247, 641, 3097, 252, 635, 3105, 
245, 648, 3102, 256, 621, 3055, 255, 625, 3038, 252, 621, 3022, 
250, 614, 3005, 243, 624, 3024, 251, 631, 3046, 255, 611, 3023, 
256, 627, 3023, 253, 618, 2995, 246, 615, 2966, 249, 613, 2923, 
248, 604, 2915, 245, 604, 2965, 244, 618, 2935, 244, 612, 2932, 
252, 624, 2930, 253, 614, 2898, 248, 593, 2882, 248, 606, 2869, 
246, 605, 2829, 253, 590, 2834, 248, 613, 2835, 247, 604, 2841, 
248, 602, 2876, 251, 610, 2802, 255, 599, 2786, 250, 589, 2763, 
248, 592, 2756, 247, 584, 2732, 244, 596, 2755, 246, 591, 2783, 
251, 609, 2766, 250, 601, 2776, 254, 602, 2740, 248, 597, 2730, 
246, 580, 2696, 243, 580, 2671, 252, 589, 2657, 238, 586, 2675, 
243, 594, 2689, 245, 587, 2671, 240, 579, 2685, 243, 593, 2681, 
246, 584, 2678, 245, 581, 2643, 246, 589, 2638, 244, 573, 2602, 
242, 570, 2590, 235, 578, 2624, 246, 591, 2615, 243, 587, 2628, 
245, 595, 2656, 243, 585, 2583, 241, 587, 2575, 244, 567, 2585, 
244, 577, 2543, 239, 575, 2562, 242, 572, 2587, 241, 576, 2602, 
238), species = c("ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E", "ES", "S", "E", "ES", "S", 
"E", "ES", "S", "E", "ES", "S", "E")), row.names = c(NA, -1035L
), class = c("tbl_df", "tbl", "data.frame"))

results %>%
  ggplot(aes(x = cycle, y= od, color = species))+
  geom_line()
results %>%
  ggplot(aes(x = cycle, y= cfp, color = species))+
  geom_line()
results %>%
  ggplot(aes(x = cycle, y= yfp, color = species))+
  geom_line()

```

1. Subtract the minimum measurement from each well.

```{r minsubtract}

results = results %>%
  group_by(well, species) %>%
  mutate(od = od - min(od),
         cfp = cfp - min(cfp),
         yfp = yfp - min(yfp))


```


What we need is the amount of OD per unit of fluorescent protein, for each species. 

We get this by fitting regression lines. Note that the relationship changes after growth ceases, so we restrict our analysis to this part of growth.

```{r scatters}

results %>%
  ggplot(aes(x = cfp, y = od, color = species))+
  geom_point()
results %>%
  ggplot(aes(x = yfp, y = od, color = species))+
  geom_point()

```

I wrote code which find the region of growth. It is old code and could easily be improved, but it works for now. The functions are in bleedthrough_funcs.r and can be used within a pipe. This chunk shows it plotted. The next one does the regression of OD vs. FP for these plots. 

```{r get_growth_chunk}
source("./bleedthrough_funcs.r")
results %>% 
  filter(species != "ES") %>%
  group_by(species) %>%
  filter(cycle >= get_start_growth_time(cycle, od) & cycle <= get_max_growth_time(cycle, od)) %>%
  ggplot(aes(x = cycle, y = od, color = species))+
  geom_point()


results %>% 
  filter(species != "ES") %>%
  group_by(species) %>%
  filter(cycle >= get_start_growth_time(cycle, od) & cycle <= get_max_growth_time(cycle, od)) %>%
  ggplot(aes(x = cfp, y = od, color = species))+
  geom_point()

results %>% 
  filter(species != "ES") %>%
  group_by(species) %>%
  filter(cycle >= get_start_growth_time(cycle, od) & cycle <= get_max_growth_time(cycle, od)) %>%
  ggplot(aes(x = yfp, y = od, color = species))+
  geom_point()

results %>% 
  filter(species != "ES") %>%
  group_by(species) %>%
  filter(cycle >= get_start_growth_time(cycle, od) & cycle <= get_max_growth_time(cycle, od)) %>%
  ggplot(aes(x = cfp, y = yfp, color = species))+
  geom_point()


```

Now we get the coefficients and put them into a table. if the regression is not significant, we disclude it. I am doing this "manually" to make it clearer what is happening, though one could put this into a pipe if desired.

```{r get_coefs}

E_od_from_cfp = results %>% 
  filter(species == "E") %>%
  filter(cycle >= get_start_growth_time(cycle, od) & cycle <= get_max_growth_time(cycle, od)) %>%
  summarize(slope = coef(lm(od ~ cfp))[2]) %>% 
  select(slope) %>%  pull %>% unname 
E_yfp_from_cfp = results %>% 
  filter(species == "E") %>%
  filter(cycle >= get_start_growth_time(cycle, od) & cycle <= get_max_growth_time(cycle, od)) %>%
  # check for significance
  summarize(slope = ifelse(coef(summary(lm(yfp ~ cfp)))[2,4] < 0.05,
                           coef(lm(yfp ~ cfp))[2], 0)) %>%
  select(slope) %>% pull %>% unname 
S_od_from_yfp = results %>% 
  filter(species == "S") %>%
  filter(cycle >= get_start_growth_time(cycle, od) & cycle <= get_max_growth_time(cycle, od)) %>%
  summarize(slope = coef(lm(od ~ yfp))[2]) %>% 
  select(slope) %>%  pull %>% unname 
S_cfp_from_yfp = results %>% 
  filter(species == "S") %>%
  filter(cycle >= get_start_growth_time(cycle, od) & cycle <= get_max_growth_time(cycle, od)) %>%
  # check for significance
  summarize(slope = ifelse(coef(summary(lm(cfp ~ yfp)))[2,4] < 0.05,
                           coef(lm(cfp ~ yfp))[2], 0)) %>%
  select(slope) %>% pull %>% unname 


```

We compile these into a matrix which we use to solve a system of equations, which 
give us species-specific fluorescence values, which then can be multiplied to get
species-specific OD values.

```{r compilematrix}

fluorescence_matrix = matrix(c(1, S_cfp_from_yfp, E_yfp_from_cfp, 1), nrow = 2, byrow = TRUE)
print(fluorescence_matrix)

results = results %>% 
  rowwise() %>%
  mutate(E_cfp = solve(fluorescence_matrix, c(cfp, yfp))[1],
         S_yfp = solve(fluorescence_matrix, c(cfp, yfp))[2]) %>%
  mutate(E_od = E_cfp * E_od_from_cfp,
         S_od = S_yfp * S_od_from_yfp)

```

Now we have OD data on each species in the coculture, using fluorescence, with bleedthrough corrected for.

```{r showdata}

results %>%
  filter(species == "ES") %>%
  pivot_longer(cols = c(od, E_od, S_od), names_to = "signal", values_to = "od") %>%
  ggplot(aes(x = cycle, y = od, color = signal))+
  geom_line()

```

Obviously, this particular example didn't work that well--I'm time-strapped so didn't want to spend a lot of time finding a good, representative case, but in general in good cases the species-specific ODs should sum (ish) to the actual OD.